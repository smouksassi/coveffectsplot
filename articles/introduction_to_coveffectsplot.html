<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to `coveffectsplot` • coveffectsplot</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to `coveffectsplot`">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">coveffectsplot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction_to_coveffectsplot.html">Introduction to coveffectsplot</a>
    </li>
    <li>
      <a href="../articles/Exposure_Response_Example.html">Exposure-Response Example</a>
    </li>
    <li>
      <a href="../articles/PK_Example.html">PK Example</a>
    </li>
    <li>
      <a href="../articles/PK_Example_full.html">PK Example Full</a>
    </li>
    <li>
      <a href="../articles/Pediatric_Cov_Sim.html">PK Pediatric Example</a>
    </li>
    <li>
      <a href="../articles/PKPD_Example.html">PKPD Example</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/app.html">Shiny App</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/smouksassi/coveffectsplot/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to <code>coveffectsplot</code>
</h1>
                        <h4 data-toc-skip class="author">Samer
Mouksassi</h4>
            
            <h4 data-toc-skip class="date">2025-01-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/smouksassi/coveffectsplot/blob/main/vignettes/introduction_to_coveffectsplot.Rmd" class="external-link"><code>vignettes/introduction_to_coveffectsplot.Rmd</code></a></small>
      <div class="hidden name"><code>introduction_to_coveffectsplot.Rmd</code></div>

    </div>

    
    
<p>The use of forest plots to summarize the impact of various intrinsic
and extrinsic factors on the pharmacokinetics (PK) of drugs is becoming
a standard practice and a key part of submission packages to the FDA.
The forest plots format make it easier for clinicians to quickly find
and interpret the information they need.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> Additional information
can be found in the updated
<a href="https://www.fda.gov/regulatory-information/search-fda-guidance-documents/population-pharmacokinetics" class="external-link">FDA
Pop PK Guidance.</a><a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<div class="section level2">
<h2 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h2>
<p>Traditionally, a paragraph describing the various doses in various
group is part of the official drug label and often a table is provided.
The advantages of table versus graphs has been previously discussed and
each has its own merits. While web-based interactive graphics allow
on-demand mouse hovering to show the graph numbers, this is not possible
on a printed sheet of paper or on a static PDF as required for a drug
label. As such, combining a graphic representation of the data with a
side table provides the best of both worlds and provide to the clinician
an efficient way to interpret the data.<br>
The <code>coveffectsplot</code> R package aims to facilitate the
creation of forest plots using the <code><a href="../reference/forest_plot.html">forest_plot()</a></code>and
<code><a href="../reference/run_interactiveforestplot.html">run_interactiveforestplot()</a></code> functions.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>Let us assume that we have a drug following a first-order absorption
one-compartment PK model with parameters absorption constant (Ka),
Clearance (CL) and Volume of distribution (V). Usually, a nonlinear
mixed effects model is fitted to the PK data and covariates covering
intrinsic and extrinsic are tested on the various parameters. For
simplicity, let us assume that the covariate modeling did not add any
covariate on Ka and V and provided the following model for CL:</p>
<p><span class="math display">$$CL = \color{blue}{POPCL} \times \left(
\frac { \color{green}{Weight}} {70}\right)^\color{blue}{dWTdCL}\times
\left(\color{blue} {dSexdCL}\times \left( \color{green}{Sex}==
1  \right) \right)\times
exp(\color{red}\eta\color{red}{CL})$$</span></p>
<p>The above equation shows that we have two covariates on CL one is
Weight (kg) a continuous variable with reference value of 70 (kg) and
influencing CL with a power model with coefficient dWTdCL. The second is
Sex which is an indicator variable taking the value of 0 (Woman, used as
the reference category) and 1 (Man) influencing CL with a coefficient
dSexdCL. The last term denotes the individual deviations from the
population (random effects) which assumes that CL in the population is
log normally distributed. The same model can be more familiar to
statisticians if re-written into a log-linear additive form:</p>
<p><span class="math display">$$log(CL) = {log(\color{blue}{POPCL})} +
\color{blue}{dWTdCL}\times log\left(\frac { \color{green}{Weight}}
{70}\right)+ \
log(\color{blue}{dSexdCL})\times\left(\color{green}{Sex}== 1 \right)
+\color{red}\eta\color{red}{CL} $$</span> and where the individual level
random effect describes the between subject variability (BSV): <span class="math display">$$\color{red}\eta{\color{red}{CL}}\sim
\mathcal{N}(0,\,\omega_{CL}^{2})$$</span></p>
<p>As mentioned in the FDA guidance there is two ways to conduct
simulations:</p>
<ol style="list-style-type: decimal">
<li><p>Simulations Based on Uncertainty of Fixed-Effect Estimates:<br>
Where fixed effects and uncertainty are included without between subject
variability.<br>
“For example, forest plots that illustrate the effect of covariates on
the area under the concentration time curve (AUC) or other parameters
can be generated based on simulations with uncertainty in fixed-effect
parameters, thereby facilitating the interpretation of the relative
importance of covariates on exposure. These types of simulations are
also useful to evaluate the performance of new dosing regimens for
testing in future trials. Additionally, simulations with parameter
uncertainty can be used to graphically illustrate the effect of
parameter precision on PK profiles.”</p></li>
<li><p>Simulations Based on Estimates of Between-Subject
Variability:<br>
“Between-subject variability in PK parameters is accounted for in
simulations when the purpose is to show the range of individual
predictions of concentrations in the studied population. Residual error
is added to the individual prediction when the range of observed
concentrations is the main interest. If the purpose is to predict the
observed concentration range of a future population, then uncertainty in
the between-subject variability should be accounted for in addition to
the fixed effect parameters and residual error. The correlation between
random effects should be accounted for to avoid unrealistic parameter
combinations in subjects. Simulations that account for between-subject
variability and include covariate effects should be conducted in a
population with realistic demographic variables. Demographic variables
can be obtained from databases or generated by resampling with
replacement of the individuals in the original study or by sampling the
covariate distributions and their correlations in the target
population.”</p></li>
</ol>
<p>The pharmacometrician will need to decide what factors to include in
the simulations of covariate effects depending on the goal of the
simulation:</p>
<ol style="list-style-type: decimal">
<li>Fixed effects ? (POPCL, dWTdCL and dSexdCL from the model) and
associated Uncertainty (from model varcov or bootstrap): Always</li>
<li>Covariate values or distributions ? (modeled data or a database):
<ul>
<li>Univariate → to determine relative importance</li>
<li>Realistic multivariate and correlated covariate distributions → to
illustrate range of possible outcomes</li>
</ul>
</li>
<li>Random effects ? (Omega matrix from the model) and associated
Uncertainty (Inverse Wishart with degrees of freedom from n of subjects
): → to illustrate range of possible outcomes</li>
<li>Residual error and its Uncertainty ? (from model): → only when there
is interest in the predicted concentrations distributions.</li>
</ol>
<p>For the univariate covariate approach where we vary one covariate at
a time keeping all the others at the reference values, a common practice
is to report the effects of the 75th percentile to the 25th percentile
which will cover 50% of the population. However most of the time we also
want to cover 90% of the population (5th to the 95th percentiles) and
then we end up showing effects at the 5th, 25th, 50th, 75th and 95th
percentiles. For some clinical covariates some cutoffs at specific
values have clinical significance and they are used as is.</p>
<p>In many situations, the assumption of varying one covariate at a time
does not hold and we recommend to also conduct simulations with
realistic distribution of correlated covariates. We provide several
examples with both approaches in the various vignettes.</p>
<p>Since the BSV cannot be controlled for, showing the distribution of
the BSV is important to contrast and compare with the estimated
covariate related effects as this will allow us to understand where a
random subject given a known set of covariates (e.g. at reference
values) could possibly belong. We previously only showed the BSV effects
at the reference values we now recommend to conduct two full simulations
one without BSV and one with BSV to compare and contrast the results and
understand the marginal univariate covariate effects as well as the
joint multivariate covariate effects with BSV to describe the range of
possible outcomes in a population of subjects.</p>
<p>Both methods are complementary and needed in real-world
applications.</p>
</div>
<div class="section level2">
<h2 id="simulating-data-to-mimick-outputs-from-a-modeling-exercise">Simulating Data to Mimick Outputs from a Modeling Exercise<a class="anchor" aria-label="anchor" href="#simulating-data-to-mimick-outputs-from-a-modeling-exercise"></a>
</h2>
<p>We will assume that the model fit had estimated parameters with
relative standard errors of 15%. For this vignette, a simulation from a
multivariate normal distribution with n= 10000 was used. The five first
rows are shown in the table below. The assumed mean values for POPCL,
dWTdCL and dSexdCL were 10, 0.75 and 1.5 respectively. For simplicity,
we will also assume that there were equal number of Sex = 1 (Man) and
Sex = 0 (Woman) and that men and women had mean weights of 75 and 65 kg
and the same standard deviation of 20 kg. Note that unless we explicitly
code the simulation in a way to prevent negative weights (e.g. using a
log normal distribution) we will end up simulating some negative
ones.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">657687</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span><span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nuncertainty</span>,</span>
<span>                mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">0.75</span>,<span class="fl">1.5</span><span class="op">)</span>,</span>
<span>                Sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">(</span><span class="fl">10</span><span class="op">*</span><span class="fl">0.15</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>,</span>
<span>                               <span class="fl">0.001</span>,<span class="fl">0.001</span>,<span class="fl">0.001</span>,<span class="op">(</span><span class="fl">0.75</span><span class="op">*</span><span class="fl">0.15</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>,</span>
<span>                               <span class="fl">0.001</span>,<span class="fl">0.001</span>,<span class="fl">0.001</span>,<span class="op">(</span><span class="fl">1.5</span><span class="op">*</span><span class="fl">0.15</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,<span class="fl">3</span>,<span class="fl">3</span>,byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POPCL"</span>,<span class="st">"dWTdCL"</span>,<span class="st">"dSexdCL"</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">df</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">POPCL</th>
<th align="right">dWTdCL</th>
<th align="right">dSexdCL</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">9.14</td>
<td align="right">0.83</td>
<td align="right">1.20</td>
</tr>
<tr class="even">
<td align="right">10.65</td>
<td align="right">0.82</td>
<td align="right">1.51</td>
</tr>
<tr class="odd">
<td align="right">12.30</td>
<td align="right">0.88</td>
<td align="right">1.56</td>
</tr>
<tr class="even">
<td align="right">9.40</td>
<td align="right">0.88</td>
<td align="right">1.81</td>
</tr>
<tr class="odd">
<td align="right">10.37</td>
<td align="right">0.85</td>
<td align="right">1.51</td>
</tr>
</tbody>
</table>
<p><img src="introduction_to_coveffectsplot_files/figure-html/unnamed-chunk-2-1.png" width="576" style="display: block; margin: auto;"><img src="introduction_to_coveffectsplot_files/figure-html/unnamed-chunk-2-2.png" width="576" style="display: block; margin: auto;"></p>
<table class="table">
<thead><tr class="header">
<th align="left">1%</th>
<th align="left">5%</th>
<th align="left">25%</th>
<th align="left">50%</th>
<th align="left">75%</th>
<th align="left">95%</th>
<th align="left">99%</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">22</td>
<td align="left">36</td>
<td align="left">56</td>
<td align="left">70</td>
<td align="left">84</td>
<td align="left">104</td>
<td align="left">118</td>
</tr></tbody>
</table>
<p>The model had a between subject variability on CL
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ω</mi><mrow><mi>C</mi><mi>L</mi></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">\omega_{CL}^{2}</annotation></semantics></math>
variance of 0.09 which translates to apparent CV of sqrt (exp (0.09) -1)
= 0.3069. A common way to report this BSV is to say we have 30.7% BSV.
But what does this really mean in practical terms? What are the chances
that a patient with known covariate values, will have very low or very
high CL warranting dose changes?<br>
A useful metric can be to compute the bounds where say 50% and 90% of
the patients will be located using simple quantile functions on
simulated distributions. For the 30.7% BSV case, we compute that 50% of
the patients will be within the 0.82 to 1.23 interval (dark red area)
while 90% of the patients will be within the 0.61 to 1.63 interval
(lighter red area). A table showing the various quantiles is also shown.
For asymmetrical distribution we can also use the highest density
intervals instead of percentiles but this is not shown here.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">546789</span><span class="op">)</span></span>
<span><span class="va">CLBSVdistribution</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>CL<span class="op">=</span> <span class="fl">10</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nbsvsubjects</span>,<span class="fl">0</span>,sd<span class="op">=</span><span class="fl">0.09</span><span class="op">^</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">CLBSVdistribution</span><span class="op">$</span><span class="va">CLBSV</span><span class="op">&lt;-</span> <span class="va">CLBSVdistribution</span><span class="op">$</span><span class="va">CL</span><span class="op">/</span><span class="fl">10</span></span></code></pre></div>
<p><img src="introduction_to_coveffectsplot_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;"></p>
<table class="table">
<thead><tr class="header">
<th align="left">1%</th>
<th align="left">5%</th>
<th align="left">25%</th>
<th align="left">50%</th>
<th align="left">75%</th>
<th align="left">95%</th>
<th align="left">99%</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">0.49</td>
<td align="left">0.61</td>
<td align="left">0.82</td>
<td align="left">1.00</td>
<td align="left">1.22</td>
<td align="left">1.63</td>
<td align="left">2.01</td>
</tr></tbody>
</table>
<p><em>Here we overlay the various sources of variability to compare
them head to head:</em></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfeffects</span> <span class="op">&lt;-</span> <span class="va">df</span></span>
<span><span class="va">dfeffects</span><span class="op">$</span><span class="va">REFrange</span> <span class="op">&lt;-</span> <span class="va">dfeffects</span><span class="op">$</span><span class="va">POPCL</span><span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">dfeffects</span><span class="op">$</span><span class="va">POPCL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dfeffects</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">REFrange</span>,y<span class="op">=</span><span class="va">..scaled..</span>,col<span class="op">=</span><span class="st">"a.Uncertainty\nRSE=15%"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">dfcovlong</span>,</span>
<span>                        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="op">(</span><span class="va">value</span><span class="op">/</span><span class="fl">70</span><span class="op">)</span><span class="op">^</span><span class="fl">0.75</span> ,</span>
<span>                                y<span class="op">=</span><span class="va">..scaled..</span>,col<span class="op">=</span><span class="st">"b.Weight\nMean=70 kg, sd=20 kg"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">CLBSVdistribution</span> ,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">CLBSV</span>,y<span class="op">=</span><span class="va">..scaled..</span>,</span>
<span>  col<span class="op">=</span><span class="st">"c.Between subject variability\nCV=30.1%"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.8</span>,<span class="fl">1</span>,<span class="fl">1.25</span>,<span class="fl">1.5</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">""</span>,x<span class="op">=</span><span class="st">"Effects Standardized Relative\nto the Typical Value"</span>,y<span class="op">=</span> <span class="st">"Scaled Density"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="st">"green"</span>,<span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_to_coveffectsplot_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="visualizing-covariate-effects-with-distributions">Visualizing Covariate Effects with Distributions<a class="anchor" aria-label="anchor" href="#visualizing-covariate-effects-with-distributions"></a>
</h2>
<ul>
<li>First, we will divide the POPCL uncertainty distribution by its
median to standardize it. This will make everything relative to the
reference where all covariates are held at the reference value(s) here
Sex = 0 and Weight = 70 kg.</li>
<li>Second, We will compute the effects of Weight = 50 kg and 90 kg as
compared to the 70 kg. We keep dSexdCL as is, it represents the effects
of Sex = 1 effects when weight is held at its reference value = 70
kg.</li>
<li>Third, we optionally compute the effects for combination of
covariates of interest e.g. Weight = 90 kg and Sex = 1. A clinical
relevance areas e.g. between 0.8 and 1.25 of the reference value is
shown since this is often regarded as the zone of PK equivalence.
Usually, a covariate need to have effects driving PK exposures outside
of this zone to trigger actions requiring dose changes.<br>
</li>
<li>Finally, we will make a plot that compare the magnitude of
uncertainty, covariate distribution and between subject variability
effects.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfeffects</span><span class="op">$</span><span class="va">REF</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">dfeffects</span><span class="op">$</span><span class="va">SEX_FEMALE_WT_50</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">50</span><span class="op">/</span><span class="fl">70</span><span class="op">)</span><span class="op">^</span><span class="va">dfeffects</span><span class="op">$</span><span class="va">dWTdCL</span></span>
<span><span class="va">dfeffects</span><span class="op">$</span><span class="va">SEX_FEMALE_WT_90</span> <span class="op">&lt;-</span>  <span class="op">(</span><span class="fl">90</span><span class="op">/</span><span class="fl">70</span><span class="op">)</span><span class="op">^</span><span class="va">dfeffects</span><span class="op">$</span><span class="va">dWTdCL</span></span>
<span><span class="va">dfeffects</span><span class="op">$</span><span class="va">SEX_Male_WT_70</span> <span class="op">&lt;-</span> <span class="va">dfeffects</span><span class="op">$</span><span class="va">dSexdCL</span></span>
<span><span class="va">dfeffects</span><span class="op">$</span><span class="va">SEX_Male_WT_90</span> <span class="op">&lt;-</span> <span class="va">dfeffects</span><span class="op">$</span><span class="va">dSexdCL</span><span class="op">*</span><span class="op">(</span><span class="fl">90</span><span class="op">/</span><span class="fl">70</span><span class="op">)</span><span class="op">^</span><span class="va">dfeffects</span><span class="op">$</span><span class="va">dWTdCL</span></span>
<span><span class="va">dfeffects</span><span class="op">$</span><span class="va">BSV_REF</span><span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">CLBSVdistribution</span><span class="op">$</span><span class="va">CLBSV</span>, <span class="va">nuncertainty</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dfeffects</span><span class="op">&lt;-</span> <span class="va">dfeffects</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SEX_FEMALE_WT_50"</span>,</span>
<span>                         <span class="st">"SEX_FEMALE_WT_90"</span>,</span>
<span>                         <span class="st">"SEX_Male_WT_70"</span>,</span>
<span>                         <span class="st">"SEX_Male_WT_90"</span>,</span>
<span>                         <span class="st">"REF"</span>,</span>
<span>                         <span class="st">"BSV_REF"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="va">dflong</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="va">dfeffects</span>,<span class="va">key</span>,<span class="va">value</span>,<span class="op">-</span><span class="va">REF</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dflong</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">value</span>,y<span class="op">=</span><span class="va">key</span>,fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">..quantile..</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span><span class="fu">ggridges</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/ggridges/reference/stat_density_ridges.html" class="external-link">stat_density_ridges</a></span><span class="op">(</span></span>
<span>  geom <span class="op">=</span> <span class="st">"density_ridges_gradient"</span>, calc_ecdf <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  quantile_lines <span class="op">=</span> <span class="cn">TRUE</span>, rel_min_height <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  quantiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.5</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Probability"</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#FF0000A0"</span>, <span class="st">"white"</span>,<span class="st">"white"</span>, <span class="st">"#0000FFA0"</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"(0, 0.05]"</span>, <span class="st">"(0.05, 0.5]"</span>,<span class="st">"(0.5, 0.95]"</span>, <span class="st">"(0.95, 1]"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span></span>
<span>        <span class="st">"rect"</span>,</span>
<span>        xmin <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>        xmax <span class="op">=</span> <span class="fl">1.25</span>,</span>
<span>        ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span>        ymax <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>        fill <span class="op">=</span> <span class="st">"gray"</span>,alpha<span class="op">=</span><span class="fl">0.4</span></span>
<span>      <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Effects Relative to parameter reference value"</span>,y<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_to_coveffectsplot_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="simplifying-the-distributions-into-ranges-of-effects">Simplifying the Distributions into Ranges of Effects<a class="anchor" aria-label="anchor" href="#simplifying-the-distributions-into-ranges-of-effects"></a>
</h2>
<p>The above plots might be overloading the reader with information. We
will simplify it by removing unnecessary details and by computing the
desired stats in advance. The reference value is one by definition and
at each simulation replicate the effects are relative to the reference
of the replicate.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfeffects</span><span class="op">$</span><span class="va">SEX_Male_WT_90</span><span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">dfeffects</span><span class="op">$</span><span class="va">REF</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">dfeffectslong</span><span class="op">&lt;-</span> <span class="fu">gather</span><span class="op">(</span><span class="va">dfeffects</span><span class="op">)</span></span>
<span><span class="va">dfeffectslong</span><span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">dfeffectslong</span>,<span class="va">key</span><span class="op">)</span></span>
<span><span class="va">dfeffectslongsummaries</span><span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="va">dfeffectslong</span>,mid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">value</span>,<span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                                   lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">value</span>,<span class="fl">0.05</span><span class="op">)</span>,</span>
<span>                                   upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">value</span>,<span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dfeffectslongsummaries</span><span class="op">$</span><span class="va">paramname</span> <span class="op">&lt;-</span> <span class="st">"CL"</span></span>
<span><span class="va">dfeffectslongsummaries</span><span class="op">$</span><span class="va">covname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BSV"</span>,<span class="st">"REF"</span>,<span class="st">"Weight"</span>,<span class="st">"Weight"</span>,<span class="st">"Sex"</span><span class="op">)</span></span>
<span><span class="va">dfeffectslongsummaries</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"95% of patients"</span>,<span class="st">"70 kg/Woman"</span>,</span>
<span>                                  <span class="st">"50 kg/Woman"</span>, <span class="st">"90 kg/Woman"</span>,<span class="st">"70 kg/Man"</span><span class="op">)</span></span>
<span><span class="va">dfeffectslongsummaries</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dfeffectslongsummaries</span>,</span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>key<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BSV"</span>,<span class="st">"BSV"</span><span class="op">)</span>,</span>
<span>           mid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">dfeffects</span><span class="op">$</span><span class="va">BSV</span>,<span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">dfeffects</span><span class="op">$</span><span class="va">BSV</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">dfeffects</span><span class="op">$</span><span class="va">BSV</span>,<span class="fl">0.25</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">dfeffects</span><span class="op">$</span><span class="va">BSV</span>,<span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">dfeffects</span><span class="op">$</span><span class="va">BSV</span>,<span class="fl">0.75</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">dfeffects</span><span class="op">$</span><span class="va">BSV</span>,<span class="fl">0.95</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           paramname<span class="op">=</span> <span class="st">"CL"</span>,</span>
<span>           covname<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BSV"</span>,<span class="st">"BSV"</span><span class="op">)</span>,</span>
<span>           label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"50% of patients"</span>,<span class="st">"90% of patients"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dfeffectslongsummaries</span><span class="op">&lt;-</span> <span class="va">dfeffectslongsummaries</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">plotdata</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">dfeffectslongsummaries</span>,</span>
<span>          LABEL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mid</span>,<span class="fl">2</span><span class="op">)</span>, nsmall <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                         <span class="st">" ["</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">lower</span>,<span class="fl">2</span><span class="op">)</span>, nsmall <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="st">"-"</span>,</span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">upper</span>,<span class="fl">2</span><span class="op">)</span>, nsmall <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="st">"]"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">plotdata</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">plotdata</span><span class="op">)</span></span>
<span><span class="va">plotdata</span><span class="op">&lt;-</span> <span class="va">plotdata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"paramname"</span>,<span class="st">"covname"</span>,<span class="st">"label"</span>,<span class="st">"mid"</span>,<span class="st">"lower"</span>,<span class="st">"upper"</span>,<span class="st">"LABEL"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">plotdata</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="12%">
<col width="9%">
<col width="19%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th align="left">paramname</th>
<th align="left">covname</th>
<th align="left">label</th>
<th align="right">mid</th>
<th align="right">lower</th>
<th align="right">upper</th>
<th align="left">LABEL</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">CL</td>
<td align="left">REF</td>
<td align="left">70 kg/Woman</td>
<td align="right">1.0000000</td>
<td align="right">1.0000000</td>
<td align="right">1.0000000</td>
<td align="left">1.00 [1.00-1.00]</td>
</tr>
<tr class="even">
<td align="left">CL</td>
<td align="left">BSV</td>
<td align="left">50% of patients</td>
<td align="right">1.0032493</td>
<td align="right">0.8173299</td>
<td align="right">1.2180588</td>
<td align="left">1.00 [0.82-1.22]</td>
</tr>
<tr class="odd">
<td align="left">CL</td>
<td align="left">BSV</td>
<td align="left">90% of patients</td>
<td align="right">1.0032493</td>
<td align="right">0.6209209</td>
<td align="right">1.6280838</td>
<td align="left">1.00 [0.62-1.63]</td>
</tr>
<tr class="even">
<td align="left">CL</td>
<td align="left">Weight</td>
<td align="left">50 kg/Woman</td>
<td align="right">0.7768916</td>
<td align="right">0.7310255</td>
<td align="right">0.8262671</td>
<td align="left">0.78 [0.73-0.83]</td>
</tr>
<tr class="odd">
<td align="left">CL</td>
<td align="left">Weight</td>
<td align="left">90 kg/Woman</td>
<td align="right">1.2075104</td>
<td align="right">1.1531971</td>
<td align="right">1.2636597</td>
<td align="left">1.21 [1.15-1.26]</td>
</tr>
<tr class="even">
<td align="left">CL</td>
<td align="left">Sex</td>
<td align="left">70 kg/Man</td>
<td align="right">1.5012342</td>
<td align="right">1.1307812</td>
<td align="right">1.8728976</td>
<td align="left">1.50 [1.13-1.87]</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="plotting-the-effects-data">Plotting the Effects Data<a class="anchor" aria-label="anchor" href="#plotting-the-effects-data"></a>
</h2>
<p>First we do a customized <code>ggplot</code> but we quickly notice
that it has some issues like the lack of legend for the clinical
reference area, vertical labels etc. We then show how using
<code><a href="../reference/forest_plot.html">coveffectsplot::forest_plot</a></code> can generate a plot
annotations, a side table with values, and legends. For interactive
reordering of categories, editing of labels and more, export the data as
a “csv” and launch the shiny app via
<code><a href="../reference/run_interactiveforestplot.html">coveffectsplot::run_interactiveforestplot()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plotdata</span><span class="op">$</span><span class="va">covname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">plotdata</span><span class="op">$</span><span class="va">covname</span><span class="op">)</span></span>
<span><span class="va">plotdata</span><span class="op">$</span><span class="va">covname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">plotdata</span><span class="op">$</span><span class="va">covname</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plotdata</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">plotdata</span><span class="op">$</span><span class="va">label</span><span class="op">)</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plotdata</span><span class="op">[</span><span class="va">plotdata</span><span class="op">$</span><span class="va">covname</span><span class="op">!=</span><span class="st">"REF"</span>,<span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html" class="external-link">aes_string</a></span><span class="op">(</span></span>
<span>      y <span class="op">=</span> <span class="st">"label"</span>,</span>
<span>      x <span class="op">=</span> <span class="st">"mid"</span>,</span>
<span>      xmin <span class="op">=</span> <span class="st">"lower"</span>,</span>
<span>      xmax <span class="op">=</span> <span class="st">"upper"</span></span>
<span>    <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_pointrange</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"90 %CI\nCovariate Effects"</span><span class="op">)</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      alpha <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span>, </span>
<span>      xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">1.25</span><span class="op">)</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"gray"</span>,alpha<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">1</span>,linetype<span class="op">=</span><span class="st">"Reference"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">covname</span><span class="op">~</span><span class="va">.</span>,scales<span class="op">=</span><span class="st">"free_y"</span>,switch<span class="op">=</span><span class="st">"y"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y<span class="op">=</span><span class="st">""</span>,x<span class="op">=</span><span class="st">"Effects Relative to Reference Value"</span>,</span>
<span>                colour<span class="op">=</span><span class="st">""</span>,linetype<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_to_coveffectsplot_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span><span class="st">"./coveffectsplot.png"</span>,width <span class="op">=</span><span class="fl">9</span> ,height <span class="op">=</span> <span class="fl">6</span>,units <span class="op">=</span> <span class="st">"in"</span>,res<span class="op">=</span><span class="fl">72</span><span class="op">)</span></span>
<span> <span class="fu">coveffectsplot</span><span class="fu">::</span><span class="fu"><a href="../reference/forest_plot.html">forest_plot</a></span><span class="op">(</span><span class="va">plotdata</span><span class="op">[</span><span class="va">plotdata</span><span class="op">$</span><span class="va">covname</span><span class="op">!=</span><span class="st">"REF"</span>,<span class="op">]</span>,</span>
<span>            ref_area <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">0.8</span><span class="op">)</span>,</span>
<span>            x_facet_text_size <span class="op">=</span> <span class="fl">13</span>,</span>
<span>            y_facet_text_size <span class="op">=</span> <span class="fl">13</span>,</span>
<span>            interval_legend_text <span class="op">=</span> <span class="st">"Median (points)\n90% CI (horizontal lines)"</span>,</span>
<span>            ref_legend_text <span class="op">=</span> <span class="st">"Reference (vertical line)\n+/- 20% ratios (gray area)"</span>,</span>
<span>            area_legend_text <span class="op">=</span> <span class="st">"Reference (vertical line)\n+/- 20% ratios (gray area)"</span>,</span>
<span>            xlabel <span class="op">=</span> <span class="st">"Fold Change Relative to a 70kg Woman"</span>,</span>
<span>            facet_formula <span class="op">=</span> <span class="st">"covname~."</span>,</span>
<span>            facet_switch <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>            facet_scales <span class="op">=</span> <span class="st">"free"</span>,</span>
<span>            facet_space <span class="op">=</span> <span class="st">"fixed"</span>,</span>
<span>            paramname_shape <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            show_table_facet_strip <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>            table_position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>            table_text_size<span class="op">=</span><span class="fl">4</span>,</span>
<span>            plot_table_ratio <span class="op">=</span> <span class="fl">4</span>,</span>
<span>            legend_space_x_mult <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>            return_list <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; png </span></span>
<span><span class="co">#&gt;   2</span></span></code></pre></div>
<p><img src="coveffectsplot.png"></p>
<p>Using interactive graphics with hover on-demand functionality would
remove the need for a side table, this can be achieved using
<code>plotly</code>. The code is included but not evaluated to keep the
size of the vignette small.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span>  <span class="va">plotdata</span><span class="op">&lt;-</span> <span class="va">plotdata</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span>,<span class="op">]</span></span>
<span>  <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/plot_ly.html" class="external-link">plot_ly</a></span><span class="op">(</span><span class="va">plotdata</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/add_trace.html" class="external-link">add_segments</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">lower</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  xend <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">upper</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="op">~</span> <span class="va">label</span>,</span>
<span>  yend <span class="op">=</span> <span class="op">~</span> <span class="va">label</span>,</span>
<span>  name <span class="op">=</span> <span class="st">'90%CI'</span>,</span>
<span>  line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/toRGB.html" class="external-link">toRGB</a></span><span class="op">(</span><span class="st">"blue"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  hoverinfo <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>  text <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"&lt;/br&gt; 90%CI: "</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">lower</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">upper</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/add_trace.html" class="external-link">add_markers</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mid</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="op">~</span> <span class="va">label</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"Median"</span>,</span>
<span>  marker  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  color <span class="op">=</span> <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/toRGB.html" class="external-link">toRGB</a></span><span class="op">(</span><span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  symbol <span class="op">=</span> <span class="st">"diamond"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  hoverinfo <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>  text <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"&lt;/br&gt; Median: "</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mid</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">plotly</span><span class="fu">::</span><span class="fu">layout</span><span class="op">(</span></span>
<span>  xaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  title <span class="op">=</span> <span class="st">'Effects Relative to Reference'</span>,</span>
<span>  ticks <span class="op">=</span> <span class="st">"outside"</span>,</span>
<span>  autotick <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ticklen <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  gridcolor <span class="op">=</span> <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/toRGB.html" class="external-link">toRGB</a></span><span class="op">(</span><span class="st">"gray50"</span><span class="op">)</span>,</span>
<span>  showline <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> ,</span>
<span>  yaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span></span>
<span>  title <span class="op">=</span> <span class="st">''</span> ,</span>
<span>  autorange <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  type <span class="op">=</span> <span class="st">"category"</span>,</span>
<span>  categoryorder <span class="op">=</span> <span class="st">"trace"</span>, </span>
<span>  ticks <span class="op">=</span> <span class="st">"outside"</span>,</span>
<span>  autotick <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ticklen <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  gridcolor <span class="op">=</span> <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/toRGB.html" class="external-link">toRGB</a></span><span class="op">(</span><span class="st">"gray50"</span><span class="op">)</span>,</span>
<span>  showline <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span>,</span>
<span>     shapes <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      type <span class="op">=</span> <span class="st">"rect"</span>, </span>
<span>      x0 <span class="op">=</span> <span class="fl">0.8</span>, </span>
<span>      x1 <span class="op">=</span> <span class="fl">1.25</span>, </span>
<span>      xref <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>      yref <span class="op">=</span> <span class="st">"paper"</span>,</span>
<span>      y0 <span class="op">=</span> <span class="fl">0</span>, </span>
<span>      y1 <span class="op">=</span> <span class="fl">1</span>, </span>
<span>      line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>      fillcolor <span class="op">=</span>  <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/toRGB.html" class="external-link">toRGB</a></span><span class="op">(</span><span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>The <code>return_list</code> option allows you to choose to return a
list of ggplot objects that can be further manipulated.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span><span class="st">"./coveffectsplot2.png"</span>,width <span class="op">=</span><span class="fl">9</span> ,height <span class="op">=</span> <span class="fl">6</span>,units <span class="op">=</span> <span class="st">"in"</span>,res<span class="op">=</span><span class="fl">72</span><span class="op">)</span></span>
<span> <span class="va">plotlist</span><span class="op">&lt;-</span> <span class="fu">coveffectsplot</span><span class="fu">::</span><span class="fu"><a href="../reference/forest_plot.html">forest_plot</a></span><span class="op">(</span><span class="va">plotdata</span>,</span>
<span>            ref_area <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">0.8</span><span class="op">)</span>,</span>
<span>            x_facet_text_size <span class="op">=</span> <span class="fl">13</span>,</span>
<span>            y_facet_text_size <span class="op">=</span> <span class="fl">13</span>,</span>
<span>            interval_legend_text <span class="op">=</span> <span class="st">"Median (points)\n90% CI (horizontal lines)"</span>,</span>
<span>            ref_legend_text <span class="op">=</span> <span class="st">"Reference\n(vertical line)\n+/- 20% ratios\n(gray area)"</span>,</span>
<span>            area_legend_text <span class="op">=</span> <span class="st">"Reference\n(vertical line)\n+/- 20% ratios\n(gray area)"</span>,</span>
<span>            xlabel <span class="op">=</span> <span class="st">"Fold Change Relative to Parameter"</span>,</span>
<span>            facet_formula <span class="op">=</span> <span class="st">"covname~."</span>,</span>
<span>            facet_switch <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>            facet_scales <span class="op">=</span> <span class="st">"free"</span>,</span>
<span>            facet_space <span class="op">=</span> <span class="st">"fixed"</span>,</span>
<span>            paramname_shape <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>            combine_interval_shape_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            table_position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>            table_text_size <span class="op">=</span> <span class="fl">4</span>,</span>
<span>            plot_table_ratio <span class="op">=</span> <span class="fl">4</span>,</span>
<span>            show_table_facet_strip <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>            legend_space_x_mult <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>            ref_area_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/col2rgb.html" class="external-link">col2rgb</a></span><span class="op">(</span><span class="st">"gray50"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/col2rgb.html" class="external-link">col2rgb</a></span><span class="op">(</span><span class="st">"gray50"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/grDevices/col2rgb.html" class="external-link">col2rgb</a></span><span class="op">(</span><span class="st">"gray50"</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>             max <span class="op">=</span> <span class="fl">255</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">*</span><span class="fl">255</span> <span class="op">)</span> ,</span>
<span>             interval_col <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>            return_list <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">egg</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/egg/man/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span></span>
<span>      <span class="va">plotlist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">+</span> </span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Changes Relative to "</span>,</span>
<span>                                     <span class="va">CL</span><span class="op">[</span><span class="st">"subscript"</span><span class="op">]</span><span class="op">^</span><span class="va">alpha</span><span class="op">[</span><span class="st">"beta"</span><span class="op">]</span>, <span class="st">" Reference"</span><span class="op">)</span>,</span>
<span>                               sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>strip.text.y <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>colour<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       <span class="va">plotlist</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> ,</span>
<span>      nrow <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span></span>
<span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; png </span></span>
<span><span class="co">#&gt;   2</span></span></code></pre></div>
<p><img src="coveffectsplot2.png"></p>
<p>In this introductory vignette we covered univariate covariate effects
where we vary one at a time. Refer to the other vignettes for more
advanced examples illustrating full simulation of PK or PK/PD or
exposure-response models including the use of full covariate
distributions with BSV. Returning lists of plots allows the user to
further modify and edit the ggplot objects using any other third party
packages and tools.</p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>Essential pharmacokinetic information for drug dosage
decisions: a concise visual presentation in the drug label. Clin
Pharmacol Ther. 2011 Sep;90(3):471-4.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Population Pharmacokinetics Guidance for Industry
February 2022.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Samer Mouksassi, Benjamin Rich.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
