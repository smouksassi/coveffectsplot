<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exposure-Response Model Assessing the Impact of Covariates on Probabilities of Clinical Outcome • coveffectsplot</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Exposure-Response Model Assessing the Impact of Covariates on Probabilities of Clinical Outcome">
<meta property="og:description" content="coveffectsplot">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">coveffectsplot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.3.9999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introduction_to_coveffectsplot.html">Introduction to coveffectsplot</a>
    </li>
    <li>
      <a href="../articles/Exposure_Response_Example.html">Exposure-Response Example</a>
    </li>
    <li>
      <a href="../articles/PK_Example.html">PK Example</a>
    </li>
    <li>
      <a href="../articles/PK_Example_full.html">PK Example Full</a>
    </li>
    <li>
      <a href="../articles/Pediatric_Cov_Sim.html">PK Pediatric Example</a>
    </li>
    <li>
      <a href="../articles/PKPD_Example.html">PKPD Example</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/app.html">Shiny App</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/smouksassi/coveffectsplot/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Exposure-Response Model Assessing the Impact of
Covariates on Probabilities of Clinical Outcome</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/smouksassi/coveffectsplot/blob/HEAD/vignettes/Exposure_Response_Example.Rmd" class="external-link"><code>vignettes/Exposure_Response_Example.Rmd</code></a></small>
      <div class="hidden name"><code>Exposure_Response_Example.Rmd</code></div>

    </div>

    
    
<p>Here we illustrate the approach using a Binary response linked to
exposure (AUC) via a saturating EMAX function. Weight is a covariate on
Clearance. We also have a disease severity categorical covariate on EMAX
where patient with severe disease have a lower EMAX.</p>
<div class="section level2">
<h2 id="specifying-an-exposure-response-model-using-mrgsolve">Specifying an Exposure Response Model using
<code>mrgsolve</code><a class="anchor" aria-label="anchor" href="#specifying-an-exposure-response-model-using-mrgsolve"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the typical probability from the model parameters will be :</span></span>
<span><span class="va">TypicalProb</span><span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">5</span><span class="op">*</span><span class="fl">75</span><span class="op">/</span><span class="fl">10</span><span class="op">/</span><span class="op">(</span><span class="fl">7.5</span><span class="op">+</span><span class="fl">75</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MaxProb</span><span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">5</span><span class="op">*</span><span class="fl">750</span><span class="op">/</span><span class="fl">10</span><span class="op">/</span><span class="op">(</span><span class="fl">7.5</span><span class="op">+</span><span class="fl">750</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MinProb</span><span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">5</span><span class="op">*</span><span class="fl">0</span><span class="op">/</span><span class="fl">10</span><span class="op">/</span><span class="op">(</span><span class="fl">7.5</span><span class="op">+</span><span class="fl">0</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">exprespmodel</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">$PLUGIN Rcpp</span></span>
<span><span class="st">$PARAM @annotated</span></span>
<span><span class="st">TVCL    : 10  : Clearance CL (L/h)</span></span>
<span><span class="st">WTCL    : 0.75: Weight on CL (ref. 70 kg)</span></span>
<span><span class="st">TVEMAX  : 5   : Maximum Drug Effect</span></span>
<span><span class="st">SEVEMAX : 3   : Severity Reduction of Drug Effect</span></span>
<span><span class="st">AUC50   : 7.5 : Area Under the Curve providing half maximal response</span></span>
<span><span class="st">BASEP   : 0.1 : Baseline Probability of Response </span></span>
<span><span class="st"></span></span>
<span><span class="st">$PARAM @annotated // reference values for covariate</span></span>
<span><span class="st">WT      : 70  : Weight (kg)</span></span>
<span><span class="st">SEV     : 0   : Sex (0=Female, 1=Male)</span></span>
<span><span class="st">DOSE    : 75  : Dose (mg)</span></span>
<span><span class="st">$OMEGA @annotated @block</span></span>
<span><span class="st">nCL     :0.09 : ETA on CL</span></span>
<span><span class="st"></span></span>
<span><span class="st"></span></span>
<span><span class="st">$PRED</span></span>
<span><span class="st">double CL = TVCL *</span></span>
<span><span class="st">    pow((WT/70.0), WTCL)*exp(ETA(1)); </span></span>
<span><span class="st">double EMAX = TVEMAX - SEVEMAX*(SEV == 1) ; </span></span>
<span><span class="st">double Intercept = log(BASEP/(1-BASEP));</span></span>
<span><span class="st">capture CLi = CL;</span></span>
<span><span class="st">capture AUC = DOSE/CL;</span></span>
<span><span class="st">capture LGST = Intercept + (EMAX*AUC/(AUC50+AUC));</span></span>
<span><span class="st">capture P1 = 1/(1+exp(-LGST));</span></span>
<span><span class="st">capture DV = R::runif(0,1)&lt; P1 ? 1 : 0;</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="va">modexprespsim</span> <span class="op">&lt;-</span> <span class="fu">mcode</span><span class="op">(</span><span class="st">"exprespmodel"</span>, <span class="va">exprespmodel</span><span class="op">)</span></span>
<span><span class="va">simdata</span> <span class="op">&lt;-</span>  <span class="fu">expand.idata</span><span class="op">(</span>SEV<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>               DOSE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">75</span><span class="op">)</span>,</span>
<span>               ID <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>WT <span class="op">=</span> <span class="fl">70</span><span class="op">)</span> <span class="co">#exp(rnorm(n(),log(70),0.3)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">466548</span><span class="op">)</span></span>
<span><span class="va">simout</span> <span class="op">&lt;-</span> <span class="va">modexprespsim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">data_set</span><span class="op">(</span><span class="va">simdata</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">carry.out</span><span class="op">(</span><span class="va">WT</span>, <span class="va">DOSE</span>, <span class="va">SEV</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">mrgsim</span><span class="op">(</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="va">as.data.frame</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="probability-of-cure">Probability of Cure<a class="anchor" aria-label="anchor" href="#probability-of-cure"></a>
</h2>
<p>This is a plot of the disease being cured versus PK exposure by
disease severity and by Weight intervals.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">WT_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">'70'</span><span class="op">=</span><span class="st">"Weight: 70 kg"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">SEV_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">'0'</span><span class="op">=</span><span class="st">"Severity: 0 (Not Severe)"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">probplot</span><span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">simout</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">AUC</span>,<span class="va">DV</span>,linetype<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">SEV</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span> <span class="va">WT</span><span class="op">~</span><span class="va">SEV</span>,labeller<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller</a></span><span class="op">(</span>WT<span class="op">=</span><span class="va">WT_names</span>,SEV<span class="op">=</span><span class="va">SEV_names</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>height<span class="op">=</span><span class="fl">0.02</span>,width<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">DOSE</span><span class="op">)</span><span class="op">)</span>,size<span class="op">=</span><span class="fl">1</span>,alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">P1</span><span class="op">)</span>,color<span class="op">=</span><span class="st">"black"</span>,size<span class="op">=</span><span class="fl">1.1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_label</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    x<span class="op">=</span><span class="fl">9</span>,y<span class="op">=</span><span class="va">TypicalProb</span>,label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="va">TypicalProb</span>,<span class="fl">1</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,SEV<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,label<span class="op">=</span><span class="va">label</span><span class="op">)</span>,fill<span class="op">=</span><span class="st">"transparent"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_label</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    x<span class="op">=</span><span class="fl">0.37</span>,y<span class="op">=</span><span class="fl">0.1</span>,label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">0.1</span>,<span class="fl">1</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,SEV<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,label<span class="op">=</span><span class="va">label</span><span class="op">)</span>,fill<span class="op">=</span><span class="st">"transparent"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"Dose (mg)"</span>,y<span class="op">=</span><span class="st">"Probability of Response"</span>,</span>
<span>       linetype<span class="op">=</span><span class="st">"Severity"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span>
<span><span class="va">probplot</span></span></code></pre></div>
<p><img src="Exposure_Response_Example_files/figure-html/exprespmodeplotl-1.png" width="672"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simoutbsvplacebo</span> <span class="op">&lt;-</span> <span class="va">simout</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">DOSE</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>LGST <span class="op">=</span><span class="va">LGST</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">gather</span><span class="op">(</span><span class="va">paramname</span>, <span class="va">paramvalue</span>,<span class="va">LGST</span>,<span class="va">P1</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">paramname</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>P50 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">paramvalue</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">simoutbsv</span> <span class="op">&lt;-</span> <span class="va">simout</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>logodds <span class="op">=</span><span class="va">LGST</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">DOSE</span><span class="op">==</span><span class="fl">75</span><span class="op">)</span></span>
<span><span class="co"># the probability of response at the typical AUC</span></span>
<span><span class="va">simoutbsvlong</span>  <span class="op">&lt;-</span> <span class="va">simoutbsv</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>P1std<span class="op">=</span><span class="va">P1</span><span class="op">/</span><span class="va">TypicalProb</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gather</span><span class="op">(</span><span class="va">paramname</span>, <span class="va">paramvalue</span>,<span class="va">P1std</span>,<span class="va">P1</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">yvar_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">'P1std'</span><span class="op">=</span><span class="st">"Standardized Probability"</span>,</span>
<span>  <span class="st">'P1'</span><span class="op">=</span><span class="st">"Probability"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pbsvranges</span><span class="op">&lt;-</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">simoutbsvlong</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>        x      <span class="op">=</span> <span class="va">paramvalue</span>,</span>
<span>        y      <span class="op">=</span> <span class="va">paramname</span>,</span>
<span>        fill   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">..quantile..</span><span class="op">)</span>,</span>
<span>        height <span class="op">=</span> <span class="va">..ndensity..</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="va">paramname</span><span class="op">~</span><span class="va">.</span> , scales<span class="op">=</span><span class="st">"free"</span>, ncol<span class="op">=</span><span class="fl">1</span>,</span>
<span>             labeller<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller</a></span><span class="op">(</span>paramname<span class="op">=</span><span class="va">yvar_names</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_density_ridges</span><span class="op">(</span></span>
<span>    geom<span class="op">=</span><span class="st">"density_ridges_gradient"</span>, calc_ecdf<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>    quantile_lines<span class="op">=</span><span class="cn">TRUE</span>, rel_min_height<span class="op">=</span><span class="fl">0.001</span>, scale<span class="op">=</span><span class="fl">0.9</span>,</span>
<span>    quantiles<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    name<span class="op">=</span><span class="st">"Probability"</span>,</span>
<span>    values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"#FF000050"</span>, <span class="st">"#FF0000A0"</span>, <span class="st">"#FF0000A0"</span>, <span class="st">"#FF000050"</span>, <span class="st">"white"</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"(0, 0.05]"</span>, <span class="st">"(0.05, 0.25]"</span>,</span>
<span>             <span class="st">"(0.25, 0.5]"</span>, <span class="st">"(0.5, 0.75]"</span>,</span>
<span>             <span class="st">"(0.75, 0.95]"</span>, <span class="st">"(0.95, 1]"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    axis.text.y     <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks.y    <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.title.y    <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Parameters"</span>, y<span class="op">=</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>expand<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pbsvranges</span></span></code></pre></div>
<p><img src="Exposure_Response_Example_files/figure-html/bsvrangeplot-1.png" width="672"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">simoutbsvranges</span> <span class="op">&lt;-</span> <span class="va">simoutbsvlong</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">paramname</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>   P05 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">paramvalue</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>    P25 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">paramvalue</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>    P50 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">paramvalue</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    P75 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">paramvalue</span>, <span class="fl">0.75</span><span class="op">)</span>,</span>
<span>    P95 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">paramvalue</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">simoutbsvranges</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span></span>
<span><span class="co">#&gt;   paramname   P05   P25   P50   P75   P95</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> P1        0.425 0.514 0.576 0.630 0.712</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> P1std     0.740 0.893 1.00  1.10  1.24</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="computing-the-odds-and-probabilities">Computing the Odds and Probabilities<a class="anchor" aria-label="anchor" href="#computing-the-odds-and-probabilities"></a>
</h2>
<p>Here we show how the odds and probabilities can be computed. We
already know that the distribution of AUC depends on the Dose and on the
clearance distributions. The model had five parameters shown in <span style="color: red;">red</span>, the dose, disease severity and weight
were covariates and are shown in <span style="color: green;">green</span>. A Change in body weight will trigger
a change in Clearance which in turn will control the AUC. To define an
odds ratio we need to define a reference odds with reference covariate
values Severity = 0 and changes in covariate values for example Severity
= 1 (everything else being equal). For nonlinear relationships, in
addition to the covariate unit change e.g. 25 mg change of dose it is
important to define what reference value we are using e.g. A change from
Placebo = 0 mg to 25 mg is not the same as a change from the typical
dose of 75 mg increasing it to 100 mg.</p>
<p>where: <span class="math display">\[AUC = \left(\frac {
\color{green}{Dose}} {\color{red}{CL} \times \left( \frac {
\color{green}{Weight}} {70}\right)^{WTCL} \times exp(\eta{CL})
}\right)\]</span> <span class="math display">\[E_{max}=
\color{red}{E_{max} \left(intercept \right)} +
\color{red}{SevE_{max}}\times\left(\color{green}{Severity} = 1\right)
\]</span> <span class="math display">\[log(odds) =
\color{red}{intercept} + \left( \frac {E_{max} \times \color{blue}{AUC}}
{\color{red}{AUC_{50}} +\color{blue}{AUC} }\right)\]</span></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">678549</span><span class="op">)</span></span>
<span><span class="va">thmeans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">0.75</span>, <span class="co">#TVCL WTCL</span></span>
<span>             <span class="fl">5</span>,<span class="fl">3</span>, <span class="co"># TVEMAX  SEVEMAX</span></span>
<span>             <span class="fl">7.5</span>, <span class="co"># AUC50</span></span>
<span>              <span class="fl">0.1</span><span class="op">)</span> <span class="co">#BASEP</span></span>
<span><span class="va">thvariances</span><span class="op">&lt;-</span> <span class="op">(</span><span class="va">thmeans</span><span class="op">*</span><span class="fl">0.15</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">thecorrelations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>ncol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">thmeans</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">thmeans</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">thecorrelations</span><span class="op">)</span><span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">thecorrelations</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">thecorrelations</span>, diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span><span class="va">thecorrelations</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">thecorrelations</span>, diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span><span class="va">thevarcovmatrix</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">thvariances</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">thecorrelations</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">thvariances</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sim_parameters</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nsim</span>, mu<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">thmeans</span><span class="op">)</span>,</span>
<span>                                Sigma<span class="op">=</span><span class="va">thevarcovmatrix</span>, empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sim_parameters</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">thevarcovmatrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TVCL"</span>,<span class="st">"WTCL"</span>,</span>
<span>                                                           <span class="st">"TVEMAX"</span>,<span class="st">"SEVEMAX"</span>,<span class="st">"AUC50"</span>,</span>
<span>                                                           <span class="st">"BASEP"</span><span class="op">)</span></span>
<span><span class="va">sim_parameters</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">sim_parameters</span><span class="op">)</span></span>
<span></span>
<span><span class="va">reference.values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>WT <span class="op">=</span> <span class="fl">70</span>, DOSE <span class="op">=</span> <span class="fl">75</span>, SEV <span class="op">=</span> <span class="fl">0</span> <span class="op">)</span>   </span>
<span><span class="va">covcomb</span> <span class="op">&lt;-</span> <span class="fu">expand.modelframe</span><span class="op">(</span></span>
<span>  WT  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">60</span>,<span class="fl">70</span>,<span class="fl">80</span>,<span class="fl">90</span><span class="op">)</span>,</span>
<span>  DOSE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">25</span>,<span class="fl">50</span>,<span class="fl">75</span>,<span class="fl">100</span>,<span class="fl">125</span>,<span class="fl">150</span><span class="op">)</span>,</span>
<span>  SEV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>  rv <span class="op">=</span> <span class="va">reference.values</span><span class="op">)</span></span>
<span><span class="va">covcomb</span> <span class="op">&lt;-</span> <span class="va">covcomb</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">covcomb</span><span class="op">$</span><span class="va">WT</span>,<span class="va">covcomb</span><span class="op">$</span><span class="va">WT</span>,<span class="va">covcomb</span><span class="op">$</span><span class="va">DOSE</span>,<span class="va">covcomb</span><span class="op">$</span><span class="va">SEV</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">covcomb</span><span class="op">$</span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">covcomb</span><span class="op">)</span></span>
<span></span>
<span><span class="va">iter_sims</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsim</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">idata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">covcomb</span><span class="op">)</span></span>
<span>  <span class="va">idata</span><span class="op">$</span><span class="va">covname</span><span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="va">data.all</span> <span class="op">&lt;-</span> <span class="va">idata</span></span>
<span>  <span class="va">data.all</span><span class="op">$</span><span class="va">TVCL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sim_parameters</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">data.all</span><span class="op">$</span><span class="va">WTCL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sim_parameters</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">data.all</span><span class="op">$</span><span class="va">TVEMAX</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sim_parameters</span><span class="op">[</span><span class="va">i</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">data.all</span><span class="op">$</span><span class="va">SEVEMAX</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sim_parameters</span><span class="op">[</span><span class="va">i</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">data.all</span><span class="op">$</span><span class="va">AUC50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sim_parameters</span><span class="op">[</span><span class="va">i</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">data.all</span><span class="op">$</span><span class="va">BASEP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sim_parameters</span><span class="op">[</span><span class="va">i</span>,<span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">modexprespsim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">data_set</span><span class="op">(</span><span class="va">data.all</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">carry.out</span><span class="op">(</span><span class="va">CL</span>,<span class="va">WT</span>, <span class="va">DOSE</span>, <span class="va">SEV</span>, <span class="va">AUC</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">zero_re</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu">mrgsim</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">dfsimunc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">out</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>rep <span class="op">=</span> <span class="va">i</span><span class="op">)</span> <span class="op">)</span></span>
<span>  <span class="va">iter_sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">iter_sims</span>,<span class="va">dfsimunc</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stdprobplot</span><span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iter_sims</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">DOSE</span>,<span class="va">P1</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">SEV</span><span class="op">)</span> <span class="op">)</span> <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">ID</span>,<span class="va">rep</span><span class="op">)</span><span class="op">)</span>,alpha<span class="op">=</span><span class="fl">0.5</span>,size<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="va">TypicalProb</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">SEV</span><span class="op">~</span> <span class="va">WT</span>,labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y<span class="op">=</span><span class="st">"Probability of Response"</span>, colour<span class="op">=</span><span class="st">"Severity"</span><span class="op">)</span></span>
<span><span class="va">stdprobplot</span></span></code></pre></div>
<p><img src="Exposure_Response_Example_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iter_sims</span> <span class="op">&lt;-</span> <span class="va">iter_sims</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>P1std<span class="op">=</span><span class="va">P1</span><span class="op">/</span><span class="va">TypicalProb</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">gather</span><span class="op">(</span><span class="va">paramname</span>,<span class="va">paramvalue</span>,<span class="va">P1std</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span> covname <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Weight"</span>,</span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"Weight"</span>,</span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">3</span> <span class="op">~</span> <span class="st">"REF"</span>,</span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">4</span> <span class="op">~</span> <span class="st">"Weight"</span>,</span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">5</span> <span class="op">~</span> <span class="st">"Weight"</span>,</span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">6</span> <span class="op">~</span> <span class="st">"DOSE"</span>,</span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">7</span> <span class="op">~</span> <span class="st">"DOSE"</span>,</span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">8</span> <span class="op">~</span> <span class="st">"DOSE"</span>,</span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">9</span> <span class="op">~</span> <span class="st">"DOSE"</span>,</span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">10</span> <span class="op">~</span> <span class="st">"DOSE"</span>,</span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">11</span> <span class="op">~</span> <span class="st">"DOSE"</span>,</span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">12</span> <span class="op">~</span> <span class="st">"SEV"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  covvalue <span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">WT</span>,<span class="st">"kg"</span><span class="op">)</span>, </span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">WT</span>,<span class="st">"kg"</span><span class="op">)</span>,</span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">3</span> <span class="op">~</span> <span class="st">"70 kg\nNot Severe\n75 mg"</span>,</span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">4</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">WT</span>,<span class="st">"kg"</span><span class="op">)</span>,</span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">5</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">WT</span>,<span class="st">"kg"</span><span class="op">)</span>,</span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">6</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">DOSE</span>,<span class="st">"mg"</span><span class="op">)</span>,</span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">7</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">DOSE</span>,<span class="st">"mg"</span><span class="op">)</span>,</span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">8</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">DOSE</span>,<span class="st">"mg"</span><span class="op">)</span>,</span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">9</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">DOSE</span>,<span class="st">"mg"</span><span class="op">)</span>,</span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">10</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">DOSE</span>,<span class="st">"mg"</span><span class="op">)</span>,</span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">11</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">DOSE</span>,<span class="st">"mg"</span><span class="op">)</span>,</span>
<span>    <span class="va">ID</span><span class="op">==</span> <span class="fl">12</span> <span class="op">~</span> <span class="st">"Severe"</span></span>
<span>  <span class="op">)</span> <span class="op">)</span></span>
<span><span class="va">iter_sims</span><span class="op">$</span><span class="va">covname</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">iter_sims</span><span class="op">$</span><span class="va">covname</span> <span class="op">)</span>,</span>
<span>                          levels <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Weight"</span>,<span class="st">"DOSE"</span>,<span class="st">"SEV"</span>,<span class="st">"REF"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">iter_sims</span><span class="op">$</span><span class="va">covvalue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">iter_sims</span><span class="op">$</span><span class="va">covvalue</span><span class="op">)</span>,</span>
<span>                          levels <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0 mg"</span>,<span class="st">"25 mg"</span>,<span class="st">"50 mg"</span>,</span>
<span>                                      <span class="st">"100 mg"</span>,<span class="st">"125 mg"</span>,<span class="st">"150 mg"</span>,</span>
<span>                          <span class="st">"50 kg"</span>,<span class="st">"60 kg"</span>,<span class="st">"80 kg"</span>, <span class="st">"90 kg"</span>,</span>
<span>                          <span class="st">"70 kg\nNot Severe\n75 mg"</span>,  <span class="st">"Severe"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iter_sims</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">paramvalue</span>,y<span class="op">=</span><span class="va">covvalue</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">stat_density_ridges</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">..quantile..</span><span class="op">)</span>,height<span class="op">=</span><span class="va">..ndensity..</span><span class="op">)</span>,</span>
<span>    geom <span class="op">=</span> <span class="st">"density_ridges_gradient"</span>, calc_ecdf <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    quantile_lines <span class="op">=</span> <span class="cn">TRUE</span>, rel_min_height <span class="op">=</span> <span class="fl">0.001</span>,scale<span class="op">=</span><span class="fl">0.9</span>,</span>
<span>    quantiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>,<span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">covname</span><span class="op">~</span><span class="va">paramname</span>,scales<span class="op">=</span><span class="st">"free"</span>,switch<span class="op">=</span><span class="st">"both"</span>,</span>
<span>             labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller</a></span><span class="op">(</span>paramname<span class="op">=</span><span class="va">yvar_names</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Probability"</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>,<span class="st">"#0000FFA0"</span>, <span class="st">"#0000FFA0"</span>,<span class="st">"white"</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"(0, 0.025]"</span>,<span class="st">"(0.025, 0.5]"</span>,<span class="st">"(0.5, 0.975]"</span>,<span class="st">"(0.975, 1]"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,strip.placement <span class="op">=</span> <span class="st">"outside"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exposure_Response_Example_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coveffectsdatacovrep</span> <span class="op">&lt;-</span> <span class="va">iter_sims</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">paramname</span>,<span class="va">ID</span>,<span class="va">WT</span>,<span class="va">DOSE</span>,<span class="va">SEV</span>,<span class="va">covname</span>,<span class="va">covvalue</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    mid<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">paramvalue</span><span class="op">)</span>,</span>
<span>    lower<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">paramvalue</span>,<span class="fl">0.025</span><span class="op">)</span>,</span>
<span>    upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">paramvalue</span>,<span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">mid</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">simoutbsvranges</span><span class="op">&lt;-</span><span class="va">simoutbsvranges</span><span class="op">[</span><span class="va">simoutbsvranges</span><span class="op">$</span><span class="va">paramname</span><span class="op">==</span><span class="st">"P1std"</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">coveffectsdatacovrepbsv</span> <span class="op">&lt;-</span> <span class="va">coveffectsdatacovrep</span><span class="op">[</span><span class="va">coveffectsdatacovrep</span><span class="op">$</span><span class="va">covname</span><span class="op">==</span><span class="st">"REF"</span>,<span class="op">]</span></span>
<span><span class="va">coveffectsdatacovrepbsv</span><span class="op">$</span><span class="va">covname</span> <span class="op">&lt;-</span> <span class="st">"BSV"</span></span>
<span><span class="va">coveffectsdatacovrepbsv</span><span class="op">$</span><span class="va">covvalue</span> <span class="op">&lt;-</span> <span class="st">"90% of patients"</span></span>
<span><span class="va">coveffectsdatacovrepbsv</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span>    <span class="st">"90% of patients"</span></span>
<span><span class="va">coveffectsdatacovrepbsv</span><span class="op">$</span><span class="va">lower</span> <span class="op">&lt;-</span> <span class="va">simoutbsvranges</span><span class="op">$</span><span class="va">P05</span></span>
<span><span class="va">coveffectsdatacovrepbsv</span><span class="op">$</span><span class="va">upper</span> <span class="op">&lt;-</span> <span class="va">simoutbsvranges</span><span class="op">$</span><span class="va">P95</span></span>
<span><span class="va">coveffectsdatacovrepbsv2</span> <span class="op">&lt;-</span> <span class="va">coveffectsdatacovrep</span><span class="op">[</span><span class="va">coveffectsdatacovrep</span><span class="op">$</span><span class="va">covname</span><span class="op">==</span><span class="st">"REF"</span>,<span class="op">]</span></span>
<span><span class="va">coveffectsdatacovrepbsv2</span><span class="op">$</span><span class="va">covname</span> <span class="op">&lt;-</span> <span class="st">"BSV"</span></span>
<span><span class="va">coveffectsdatacovrepbsv2</span><span class="op">$</span><span class="va">covvalue</span> <span class="op">&lt;-</span> <span class="st">"50% of patients"</span></span>
<span><span class="va">coveffectsdatacovrepbsv2</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span>    <span class="st">"50% of patients"</span></span>
<span><span class="va">coveffectsdatacovrepbsv2</span><span class="op">$</span><span class="va">lower</span> <span class="op">&lt;-</span> <span class="va">simoutbsvranges</span><span class="op">$</span><span class="va">P25</span></span>
<span><span class="va">coveffectsdatacovrepbsv2</span><span class="op">$</span><span class="va">upper</span> <span class="op">&lt;-</span> <span class="va">simoutbsvranges</span><span class="op">$</span><span class="va">P75</span></span>
<span></span>
<span><span class="va">coveffectsdatacovrepbsv</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">coveffectsdatacovrep</span>,<span class="va">coveffectsdatacovrepbsv2</span>,</span>
<span>                                <span class="va">coveffectsdatacovrepbsv</span><span class="op">)</span></span>
<span></span>
<span><span class="va">coveffectsdatacovrepbsv</span> <span class="op">&lt;-</span> <span class="va">coveffectsdatacovrepbsv</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    label<span class="op">=</span> <span class="va">covvalue</span>,</span>
<span>    LABEL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mid</span>,<span class="fl">2</span><span class="op">)</span>, nsmall <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                   <span class="st">" ["</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">lower</span>,<span class="fl">2</span><span class="op">)</span>, nsmall <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="st">"-"</span>,</span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">upper</span>,<span class="fl">2</span><span class="op">)</span>, nsmall <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="st">"]"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">coveffectsdatacovrepbsv</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">coveffectsdatacovrepbsv</span><span class="op">)</span></span>
<span></span>
<span><span class="va">coveffectsdatacovrepbsv</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">coveffectsdatacovrepbsv</span><span class="op">$</span><span class="va">label</span> <span class="op">)</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"All Subjects"</span>,<span class="st">"90% of patients"</span>,<span class="st">"50% of patients"</span>,</span>
<span>              <span class="st">"50 kg"</span>,<span class="st">"60 kg"</span>,<span class="st">"80 kg"</span>,<span class="st">"90 kg"</span>,</span>
<span>              <span class="st">"0 mg"</span>,<span class="st">"25 mg"</span>,<span class="st">"50 mg"</span>,<span class="st">"100 mg"</span>,<span class="st">"125 mg"</span>,<span class="st">"150 mg"</span>,</span>
<span>              <span class="st">"Severe"</span>,<span class="st">"70 kg\nNot Severe\n75 mg"</span></span>
<span>              <span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span></span>
<span><span class="va">coveffectsdatacovrepbsv</span><span class="op">$</span><span class="va">covname</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">coveffectsdatacovrepbsv</span><span class="op">$</span><span class="va">covname</span> <span class="op">)</span>,</span>
<span>                    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Weight"</span>,<span class="st">"DOSE"</span>,<span class="st">"SEV"</span>,<span class="st">"REF"</span>,<span class="st">"BSV"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ref_legend_text</span>      <span class="op">&lt;-</span> <span class="st">"Reference (vertical line)"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span><span class="st">"./Figure_8_4.png"</span>,width <span class="op">=</span><span class="fl">9</span> ,height <span class="op">=</span> <span class="fl">7</span>,units <span class="op">=</span> <span class="st">"in"</span>,res<span class="op">=</span><span class="fl">72</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/forest_plot.html">forest_plot</a></span><span class="op">(</span><span class="va">coveffectsdatacovrepbsv</span>,</span>
<span>                            strip_placement <span class="op">=</span> <span class="st">"outside"</span>,</span>
<span>                            show_ref_area <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                            show_ref_value<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                            ref_legend_text <span class="op">=</span> <span class="va">ref_legend_text</span>,</span>
<span>                            plot_table_ratio <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                            base_size <span class="op">=</span> <span class="fl">12</span>,</span>
<span>                            table_text_size <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                            y_label_text_size      <span class="op">=</span> <span class="fl">12</span>,</span>
<span>                            xlabel<span class="op">=</span> <span class="st">" "</span>,</span>
<span>                            facet_formula <span class="op">=</span> <span class="st">"covname~paramname"</span>,</span>
<span>                            facet_labeller      <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller</a></span><span class="op">(</span>paramname<span class="op">=</span><span class="va">yvar_names</span><span class="op">)</span>,</span>
<span>                            facet_scales           <span class="op">=</span> <span class="st">"free"</span>,</span>
<span>                            facet_space <span class="op">=</span><span class="st">"free"</span>,</span>
<span>                            logxscale              <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            major_x_ticks          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.25</span>, <span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">1.5</span><span class="op">)</span>,</span>
<span>                            x_range                <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; agg_png </span></span>
<span><span class="co">#&gt;       2</span></span></code></pre></div>
<div class="figure">
<img src="../../../../../../../OneDrive%20-%20Certara/Desktop/Shiny/projects/packages/coveffectsplot/articles/Figure_8_4.png" alt=""><p class="caption">Covariate Effects Plot.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Samer Mouksassi.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
